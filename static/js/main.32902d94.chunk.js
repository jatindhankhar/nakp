(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){e.exports=a(32)},23:function(e,t,a){},25:function(e,t,a){},32:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),i=a(9),s=a.n(i),r=(a(23),a(4)),c=a(5),l=a(8),u=a(6),d=a(7),h=a(3),p=(a(25),function(){return window.googleMapLoader||(window.googleMapPromise=new Promise(function(e){window.googleMapLoader=function(){e(google),delete window.googleMapLoader},m()})),window.googleMapPromise}),m=function(){var e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyADBTO8EPakOj1iN6OtsHTLuzBOMXarVAE","&libraries=places&callback=googleMapLoader"),e.async=!0,e.defer=!0,document.body.appendChild(e)};var g=function(e){return o.a.createElement("div",{className:"text-center container-fluid"},o.a.createElement("h1",null,e.title),o.a.createElement("h2",null,o.a.createElement("a",{href:e.wikiUrl},"Read more at Wikipedia")),e.thumbnail&&o.a.createElement("img",{className:"img-responsive",src:e.thumbnail.source,alt:e.title}))},f=a(16),k=a.n(f),v=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).markers=[],a.locationMarker=null,a.makeMarkers=a.makeMarkers.bind(Object(h.a)(Object(h.a)(a))),a.setLocation=a.setLocation.bind(Object(h.a)(Object(h.a)(a))),a.showMap=a.showMap.bind(Object(h.a)(Object(h.a)(a))),a.presentLocations=[],a.prevWindow=null,a.state={gMapsFailure:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){p()}},{key:"componentWillReceiveProps",value:function(e){void 0!==this.map&&(e.location!==this.props.location?this.setLocation(e.location):e.markerLocations!==this.props.markerLocations?this.markLocations(e.markerLocations):e.selectedIndex!==this.props.selectedIndex&&this.showInfoWindow(e.selectedIndex))}},{key:"showInfoWindow",value:function(e){this.google.maps.event.trigger(this.markers[e],"click"),this.showMap(!0)}},{key:"setLocation",value:function(e){this.setState({location:e});var t=new this.google.maps.LatLng(e.lat,e.lng);this.map.panTo(t),this.locationMarker&&this.locationMarker.setMap(null),this.locationMarker=new this.google.maps.Marker({map:this.map,animation:this.google.maps.Animation.DROP,icon:{url:"https://maps.google.com/mapfiles/ms/icons/blue-dot.png"},position:t})}},{key:"markLocations",value:function(e){this.presentLocations=e,this.clearMarkers(),this.markers=this.makeMarkers(e),this.addMarkers()}},{key:"makeMarkers",value:function(e){var t=this;return e.map(function(e,a){return t.makeMarker(e,a)})}},{key:"makeMarker",value:function(e,t){var a=this,n=new this.google.maps.Marker({position:e.coordinates,animation:this.google.maps.Animation.DROP,map:this.map,label:{text:t+1+"",fontWeight:"bold"}}),i=new this.google.maps.InfoWindow({content:k.a.renderToString(o.a.createElement(g,{title:e.title,wikiUrl:e.wikiUrl,thumbnail:e.thumbnail}))});return n.addListener("click",function(){a.prevWindow&&a.prevWindow.close(),a.prevWindow=i,i.open(a.map,n)}),n}},{key:"addMarkers",value:function(){var e=this;this.markers.forEach(function(t){return t.setMap(e.map)})}},{key:"clearMarkers",value:function(){this.markers.forEach(function(e){return e.setMap(null)}),this.markers=[]}},{key:"showMap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setState({gMapsFailure:!e})}},{key:"componentDidMount",value:function(){var e=this;window.gm_authFailure=function(){alert("Failed to load Google Maps")},p().then(function(t){e.google=t,e.map=new t.maps.Map(document.getElementById("map"),{zoom:e.props.zoomLevel,center:e.props.location,fullscreenControl:!1})}).catch(function(t){return e.showMap(!1)})}},{key:"render",value:function(){return this.state.gMapsFailure?o.a.createElement("h1",null,"Failed to load Google Maps"):o.a.createElement("div",{id:"map"})}}]),t}(n.Component),b=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("form",{onSubmit:function(e){return e.preventDefault()}},o.a.createElement("div",{className:"input-group input-group-lg"},o.a.createElement("input",{type:"text",id:"search-bar",className:"lifted form-control",ref:"input",placeholder:"Search for a place"})))}},{key:"componentWillMount",value:function(){p()}},{key:"handlePlaceSelect",value:function(e){var t={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};this.props.syncLocation(t)}},{key:"setUpAutoComplete",value:function(e){var t=this,a=new e.maps.places.Autocomplete(document.getElementById("search-bar"));a.addListener("place_changed",function(){return t.handlePlaceSelect(a.getPlace())})}},{key:"componentDidMount",value:function(){var e=this;p().then(function(t){return e.setUpAutoComplete(t)})}}]),t}(n.Component),y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:400,n=function(e,t,a,n){return encodeURI("".concat("https://cors-anywhere.herokuapp.com","/").concat("https://en.wikipedia.org/w/api.php","/?action=query&prop=coordinates|pageimages|pageterms&colimit=").concat(a,"&piprop=thumbnail&pithumbsize=").concat(n,"&pilimit=").concat(a,"&wbptterms=description&generator=geosearch&ggscoord=").concat(e,"|").concat(t,"&ggsradius=10000&ggslimit=").concat(a,"&format=json"))}(e.lat,e.lng,t,a);return fetch(n,{method:"GET",headers:{Origin:null}}).then(function(e){return e.json()})},L=a(10),w=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).allLocations=[],a.state={locations:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.places.length>0&&e.places!==this.props.places&&(this.allLocations=e.places,this.setState({locations:this.allLocations}),this.sendMarkerLocations(e.places))}},{key:"getPlaces",value:function(){var e=this;return this.props.isLoading?o.a.createElement(L.b,{animated:!0,value:"100"}):this.props.isError?o.a.createElement("h2",null,"There was some error"):!this.props.isLoading&&this.state.locations&&this.state.locations.length<0?o.a.createElement("h4",null," No data available "):this.state.locations.map(function(t,a){return o.a.createElement("li",{key:t.pageid,style:{cursor:"pointer",marginBottom:"20px"},onClick:function(t){return e.handlePlaceClick(a)}},o.a.createElement("h4",null,t.title))})}},{key:"buildDatafromLocations",value:function(e){return e.map(function(e){return{coordinates:{lat:e.coordinates[0].lat,lng:e.coordinates[0].lon},title:e.title,wikiUrl:(t=e.pageid,"https://en.wikipedia.org/?curid=".concat(t)),thumbnail:e.thumbnail};var t})}},{key:"sendMarkerLocations",value:function(e){this.props.syncMarkerLocations(this.buildDatafromLocations(e))}},{key:"filterLocations",value:function(e){return this.allLocations.filter(function(t){return t.title.toLowerCase().includes(e.toLowerCase())})}},{key:"handlePlaceClick",value:function(e){this.props.syncLocationIndex(e)}},{key:"handleSearch",value:function(e){if(e.target.value&&""!==e.target.value){var t=this.filterLocations(e.target.value);this.setState({locations:t}),this.sendMarkerLocations(t)}else this.setState({locations:this.allLocations}),this.sendMarkerLocations(this.allLocations)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:this.props.sidebarOpened?"sidenav open":"sidenav"},o.a.createElement("div",{style:{padding:"10px"},className:"text-center"},o.a.createElement("div",{className:"input-group input-group-lg",style:{marginBottom:"22px"}},o.a.createElement("input",{type:"text",className:"lifted form-control",onChange:function(t){return e.handleSearch(t)},placeholder:"Type to filter"})),o.a.createElement("ol",null,this.getPlaces())))}}]),t}(n.Component),O=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).syncLocation=a.syncLocation.bind(Object(h.a)(Object(h.a)(a))),a.getUserLocation=a.getUserLocation.bind(Object(h.a)(Object(h.a)(a))),a.toggleSidebar=a.toggleSidebar.bind(Object(h.a)(Object(h.a)(a))),a.setPlaces=a.setPlaces.bind(Object(h.a)(Object(h.a)(a))),a.fetchPlaces=a.fetchPlaces.bind(Object(h.a)(Object(h.a)(a))),a.syncMarkerLocations=a.syncMarkerLocations.bind(Object(h.a)(Object(h.a)(a))),a.syncLocationIndex=a.syncLocationIndex.bind(Object(h.a)(Object(h.a)(a))),a.handleSidebarError=a.handleSidebarError.bind(Object(h.a)(Object(h.a)(a))),a.state={location:{lat:28.5274229,lng:77.1389453},zoomLevel:12,sidebarOpened:!1,markerLocations:[],places:[],isError:!1,isLoading:!0,selectedIndex:void 0},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"syncLocation",value:function(e){this.setState({location:e}),this.fetchPlaces(e)}},{key:"syncMarkerLocations",value:function(e){this.setState({markerLocations:e})}},{key:"handleSidebarError",value:function(){this.setState({isLoading:!1,isError:!0})}},{key:"getUserLocation",value:function(){var e=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){return e.syncLocation({lat:t.coords.latitude,lng:t.coords.longitude})})}},{key:"fetchPlaces",value:function(e){this.setState({places:[]}),this.state.isLoading||this.setState({isLoading:!0}),y(e).then(this.setPlaces).catch(this.handleSidebarError)}},{key:"setPlaces",value:function(e){this.setState({isLoading:!1}),e.query&&this.setState({places:Object.values(e.query.pages)})}},{key:"syncLocationIndex",value:function(e){this.setState({selectedIndex:e})}},{key:"toggleSidebar",value:function(){this.setState({sidebarOpened:!this.state.sidebarOpened})}},{key:"componentDidMount",value:function(){this.getUserLocation(),this.fetchPlaces(this.state.location)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{id:"app-container",className:this.state.sidebarOpened?"pushed":""},o.a.createElement(v,{location:this.state.location,zoomLevel:this.state.zoomLevel,markerLocations:this.state.markerLocations,selectedIndex:this.state.selectedIndex}),o.a.createElement("div",{id:"over-map"},o.a.createElement(L.a,{color:"info",id:"toggle-sidebar",onClick:this.toggleSidebar}," ",o.a.createElement("i",{className:"fa fa-2x fa-bars"}," ")," "),o.a.createElement(b,{syncLocation:this.syncLocation}))),o.a.createElement(w,{sidebarOpened:this.state.sidebarOpened,toggleSidebar:this.toggleSidebar,location:this.state.location,isLoading:this.state.isLoading,places:this.state.places,isError:this.state.isError,syncMarkerLocations:this.syncMarkerLocations,syncLocationIndex:this.syncLocationIndex}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(30);s.a.render(o.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,2,1]]]);
//# sourceMappingURL=main.32902d94.chunk.js.map